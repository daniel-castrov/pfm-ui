<j-header></j-header>
<div class="container-fluid">
  <div class="row main-content" *ngIf="programRequestPageMode.initialized">
    <div class="col-12">
      <div class="row">
        <div class="col-6" id="program-request" *ngIf="programRequestPageMode.id || programRequestPageMode.programOfMrDb">
          <div class="h5 mb-4">Program Request for Program:</div>
          <span class="form-group">
            <label>Program ID:</label> <span class="mr-sm-4">{{parentFullName}}{{pr.shortName}}</span>
          </span>
          <span class="form-group">
            <label>Name:</label> <span class="mr-sm-4">{{pr.longName}}</span>
          </span>
          <span class="form-group">
            <label>Program Type:</label> <span class="mr-sm-4">{{pr.type}}</span>
          </span>
        </div>
        <div class="col-6" id="create-new-subprogram"
            *ngIf="!programRequestPageMode.id && (programRequestPageMode.subprogramOfMrDb || programRequestPageMode.subprogramOfPrOrUfr)">
          <div class="h5 mb-4">Program Request - Creating New Sub-Program for Program:</div>
          <label for="id">Id:</label>{{parentFullName}}
          <input id="id" [formControl]="shortname" type="text" class="shortname form-control forminput mr-2" [(ngModel)]="pr.shortName" aria-label="short name">
          <label for="name">Name:</label>
          <input id="name" [formControl]="longname" type="text" class="longname form-control forminput mr-2" [(ngModel)]="pr.longName" aria-label="short name">
          <label for="type">Program Type:</label>
          <select id="type" [(ngModel)]="pr.type" class="form-control-sm type-dropdown" name="dummy">
            <option *ngFor="let type of ['INCREMENT','VARIANT','FOS']" [ngValue]="type">{{type}}</option>
          </select>
          <div class="text-danger" *ngIf="shortname.touched && shortname.invalid && shortname.errors.required">Program id is required</div>
          <div class="text-danger" *ngIf="shortname.invalid && shortname.errors.alreadyExists">Program id already exists</div>
          <div class="text-danger" *ngIf="longname.touched && longname.invalid && longname.errors.required">Program name is required</div>
          <div class="text-danger" *ngIf="longname.invalid && longname.errors.alreadyExists">Program name already exists</div>
        </div>
        <div class="col-6" id="create-new-toplevel" *ngIf="!programRequestPageMode.id && programRequestPageMode.newProgram">
          <div class="h5 mb-4">Program Request - Create new Top Level Program:</div>
          <label for="id">Id:</label>
          <input id="id"  [formControl]="shortname" type="text" class="shortname form-control forminput mr-2" [(ngModel)]="pr.shortName" aria-label="short name">
          <label for="name">Name:</label>
          <input id="name"  [formControl]="longname" type="text" class="longname form-control forminput mr-2" [(ngModel)]="pr.longName" aria-label="short name">
          <span class="form-group">
            <label>Program Type:</label> <span class="mr-sm-4">{{pr.type}}</span>
          </span>
          <div class="text-danger" *ngIf="shortname.touched && shortname.invalid && shortname.errors.required">Program id is required</div>
          <div class="text-danger" *ngIf="shortname.invalid && shortname.errors.alreadyExists">Program id already exists</div>
          <div class="text-danger" *ngIf="longname.touched && longname.invalid && longname.errors.required">Program name is required</div>
          <div class="text-danger" *ngIf="longname.invalid && longname.errors.alreadyExists">Program name already exists</div>
        </div>
        <div class="col-6">
          <div class="pull-right mb-2" aria-label="breadcrumb">
              <ol class="breadcrumb">
                <li class="breadcrumb-item active" aria-current="page">
                  <span>
                    <i class="fa fa-angle-double-left" aria-hidden="true"></i>
                  </span>
                  <span>
                    <a href="#" routerLink="/select-program-request">back to Summary Program Requests</a>
                  </span>
                </li>
              </ol>
          </div>
          <div class="pull-right program-controls">
            <span>
              <button class="btn btn-primary">Validate</button>
            </span>
            <span>
              <button class="btn btn-secondary" (click)="save('SAVED')" [disabled]="shortname.invalid || longname.invalid || pr.state=='SUBMITTED'">Save</button>
            </span>
            <span>
              <button class="btn btn-success" (click)="save('SUBMITTED')" [disabled]="shortname.invalid || longname.invalid || pr.state=='SUBMITTED'">Submit</button>
            </span>
          </div>
        </div>
      </div>
    </div>
    <div class="row main-content">
      <div class="col-12">
        <tabset class="program-tab-style" role="tablist">
          <tab heading="Program" id="tab1" role="tablist">
            <program-tab [pr]="pr" role="tabpanel"></program-tab>
          </tab>
          <tab heading="Funds" id="tab2">
            <funds-tab [pr]="pr" role="tabpanel"></funds-tab>
          </tab>
          <tab heading="Variants" id="tab3">
            <variants-tab [current]="pr" [editable]="true" role="tabpanel"></variants-tab>
          </tab>
          <tab heading="Justification" id="tab4">
            <justification-tab [pr]="pr" role="tabpanel"></justification-tab>
          </tab>
        </tabset>
      </div>
    </div>
  </div>
</div>
