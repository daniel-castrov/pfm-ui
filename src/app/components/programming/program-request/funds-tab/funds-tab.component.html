<div class="row">
  <div *ngIf="pr.type !== ProgramType.GENERIC" class="col-auto">
    <button class="btn btn-primary mb-3" (click)="addRow()" [disabled]='!addFundingLineOk()'>
      <span class="mr-2">
        <i class="fa fa-plus-circle" aria-hidden="true"></i>
      </span>
      <span>Add a new funding line</span>
    </button>
  </div>
  <div *ngIf="pr.type === ProgramType.GENERIC" class="col-auto">
    <div class="dropdown-label">
      <select [(ngModel)]="selectedFundingLine" class="form-control-sm" name="dummy">
        <option value="null" disabled selected>Select a Funding Line</option>
        <option *ngFor="let fl of existingFundingLines" [ngValue]="fl">{{fl.appropriation + '/' + fl.baOrBlin + '/' + fl.item + '/' + fl.opAgency}}</option>
      </select>
    </div>
  </div>
  <div *ngIf="pr.type === ProgramType.GENERIC" class="col-auto">
    <button [disabled]="existingFundingLines?.length === 0 || selectedFundingLine === null" class="btn btn-primary mb-3" (click)="addParentFundingLine()" [disabled]='!addFundingLineOk()'>
      <span class="icon-pad">Add parent funding line</span>
    </button>
  </div>
</div>
<ag-grid-angular #agGrid
                 *ngIf="pr.type !== ProgramType.GENERIC"
                 class="ag-theme-balham pr-funds-tab group-header-white"
                 [gridAutoHeight]="true"
                 [toolPanelSuppressPivotMode]="true"
                 [toolPanelSuppressRowGroups]="true"
                 [toolPanelSuppressValues]="true"
                 [toolPanelSuppressPivots]="true"
                 [toolPanelSuppressColumnFilter]="true"
                 [toolPanelSuppressColumnSelectAll]="true"
                 [suppressMovableColumns]="true"
                 [suppressRowTransform]="true"
                 [overlayNoRowsTemplate]="overlayNoRowsTemplate"
                 [showToolPanel]="false"
                 [enableSorting]="true"
                 [enableFilter]="true"
                 [rowData]="data"
                 [singleClickEdit]="true"
                 [pinnedBottomRowData]="pinnedBottomData"
                 [frameworkComponents]="frameworkComponents"
                 [components]="components"
                 [context]="context"
                 [stopEditingWhenGridLosesFocus]="true"
                 (columnVisible)="sizeColumnsToFit($event)"
                 (toolPanelVisibleChanged)="sizeColumnsToFit($event)"
                 (gridReady)="onGridReady($event)"
                 (cellEditingStarted)="onCellEditingStarted($event)">
</ag-grid-angular>
<fieldset *ngIf="pr.type === ProgramType.GENERIC">
  <legend>{{pr.shortName}} funding lines</legend>
  <ag-grid-angular #agGrid
                   class="ag-theme-balham pr-funds-tab group-header-white"
                   [gridAutoHeight]="true"
                   [toolPanelSuppressSideButtons]="true"
                   [suppressMovableColumns]="true"
                   [suppressRowTransform]="true"
                   [overlayNoRowsTemplate]="overlayNoRowsTemplate"
                   [showToolPanel]="false"
                   [enableSorting]="true"
                   [enableFilter]="true"
                   [rowData]="data"
                   [singleClickEdit]="true"
                   [pinnedBottomRowData]="pinnedBottomData"
                   [frameworkComponents]="frameworkComponents"
                   [components]="components"
                   [context]="context"
                   [stopEditingWhenGridLosesFocus]="true"
                   (columnVisible)="sizeColumnsToFit($event)"
                   (gridReady)="onGridReady($event)"
                   (cellEditingStarted)="onCellEditingStarted($event)">
  </ag-grid-angular>
</fieldset>

<fieldset *ngIf="showParentInformation" style="position:relative; margin-top:30px">
  <legend>Parent Information</legend>
  <button class="close-button" (click)="closeParentInformation()">
    <i class="fa fa-close"></i>
  </button>
  <ag-grid-angular #agGridParent
                   *ngIf="parentData"
                   class="ag-theme-balham pr-funds-tab group-header-white"
                   [gridAutoHeight]="true"
                   [toolPanelSuppressSideButtons]="true"
                   [suppressMovableColumns]="true"
                   [suppressRowTransform]="true"
                   [overlayNoRowsTemplate]="overlayNoRowsTemplate"
                   [showToolPanel]="false"
                   [enableSorting]="false"
                   [enableFilter]="false"
                   [defaultColDef]="defaultColumnDefs"
                   [rowData]="parentData"
                   [singleClickEdit]="true"
                   [frameworkComponents]="frameworkComponents"
                   [components]="components"
                   [context]="context"
                   (columnVisible)="sizeColumnsToFit($event)"
                   (gridReady)="onParentGridReady($event)">
  </ag-grid-angular>
</fieldset>

<fieldset *ngIf="showSiblingsInformation" style="position:relative; margin-top:30px">
  <legend>Siblings Information</legend>
  <button class="close-button" (click)="closeSiblingsInformation()">
    <i class="fa fa-close"></i>
  </button>
  <ag-grid-angular #agGridSiblings
                   *ngIf="siblingsData?.length > 0"
                   class="ag-theme-balham pr-funds-tab group-header-white"
                   [gridAutoHeight]="true"
                   [toolPanelSuppressSideButtons]="true"
                   [suppressMovableColumns]="true"
                   [suppressRowTransform]="true"
                   [overlayNoRowsTemplate]="overlayNoRowsTemplate"
                   [showToolPanel]="false"
                   [enableSorting]="false"
                   [enableFilter]="false"
                   [defaultColDef]="defaultColumnDefs"
                   [rowData]="siblingsData"
                   [pinnedBottomRowData]="pinnedSiblingsBottomData"
                   [singleClickEdit]="true"
                   [frameworkComponents]="frameworkComponents"
                   [components]="components"
                   [context]="context"
                   (columnVisible)="sizeColumnsToFit($event)"
                   (gridReady)="onSiblingsGridReady($event)">
  </ag-grid-angular>
</fieldset>
