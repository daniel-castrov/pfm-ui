<div class="main section-banner">
  <div class="title-line">
    <div style="float: left; width: 70%;">
      <h3>POM{{ pomDisplayYear }} Program Request Summary</h3>
    </div>
    <div *ngIf="appModel.visibilityDef" class="button-container">
      <div *pfmIsVisible="'requests-summary-component.returnOrganization'" class="div-button-return">
        <button type="button" class="btn btn-danger" (click)="onReturnOrganization()">
          <fa-icon [icon]="'arrow-left'"></fa-icon> Return Organization
        </button>
      </div>
      <div *pfmIsVisible="'requests-summary-component.approveOrganization'" class="div-button-approve">
        <button type="button" class="btn btn-success" (click)="onApproveOrganization()">
          <fa-icon [icon]="'check'"></fa-icon> Approve Organization
        </button>
      </div>
      <div *pfmIsVisible="'requests-summary-component.advanceOrganization'" class="div-button-advance">
        <button type="button" class="btn btn-primary" (click)="onAdvanceOrganization()">
          <fa-icon [icon]="'arrow-right'"></fa-icon> Advance Organization
        </button>
      </div>
      <div *pfmIsVisible="'requests-summary-component.approveAllPRs'" class="div-button-approve-all">
        <button type="button" class="btn btn-primary" (click)="onApprove()">
          Approve All PRs - Demo only
        </button>
      </div>
    </div>
  </div>
  <pfm-dropdown
    *ngIf="availableOrgs"
    (selectionChanged)="organizationSelected($event)"
    [type]="'labelDropdown'"
    [label]="'Select Organization to View:'"
    [required]="true"
    [id]="'availableOrgsDropDown'"
    [defaultOption]="dropdownDefault"
    [fieldName]="'name'"
    [fieldLabel]="'name'"
    [options]="availableOrgs"
  >
  </pfm-dropdown>
</div>

<div *ngIf="programmingModelReady" class="section-pods">
  <gridster [options]="options">
    <gridster-item #orgWidetItem [item]="dashboard[0]">
      <div class="gridster-item-content">
        <pfm-requests-summary-org-widget
          #orgWidget
          [griddata]="griddata"
          [orgs]="orgs"
          [roles]="programmingModel.roles"
        >
        </pfm-requests-summary-org-widget>
      </div>
    </gridster-item>

    <gridster-item #toaWidetItem [item]="dashboard[1]">
      <div class="gridster-item-content">
        <pfm-requests-summary-toa-widget
          #toaWidget
          [availableCharts]="availableToaCharts"
          [pomYear]="pomYear"
          [selectedOrg]="selectedOrg"
          [programmingModel]="programmingModel"
          [griddata]="griddata"
        >
        </pfm-requests-summary-toa-widget>
      </div>
    </gridster-item>
  </gridster>
</div>

<div *ngIf="programmingModelReady" class="section-datagrid">
  <div class="datagrid">
    <pfm-requests-summary-grid
      (addCtaEvent)="handleAdd($event)"
      (gridDataChange)="onGridDataChange($event)"
      [dropdownOptions]="addOptions"
      [pomYear]="pomYear"
    ></pfm-requests-summary-grid>
  </div>
</div>

<ng-container *ngIf="showPreviousFundedProgramDialog">
  <pfm-custom-dialog
    [title]="'Select a Program'"
    [body]="importPreviousFundedProgramBody"
    [actions]="importPreviousFundedProgramActions"
    (onCancelDialog)="showPreviousFundedProgramDialog = false"
  >
  </pfm-custom-dialog>

  <ng-template #importPreviousFundedProgramBody>
    <pfm-dropdown
      (selectionChanged)="importProgramSelected($event)"
      [type]="'labelDropdown'"
      [label]="''"
      [required]="true"
      [id]="'id'"
      [fieldName]="'name'"
      [fieldLabel]="'name'"
      [options]="availablePrograms"
    >
    </pfm-dropdown>
  </ng-template>

  <ng-template #importPreviousFundedProgramActions>
    <div class="button-container">
      <div class="confirm">
        <button
          type="button"
          class="btn btn-primary"
          data-dismiss="modal"
          (click)="showPreviousFundedProgramDialog = false; onImportProgram()"
        >
          OK
        </button>
      </div>
      <div class="cancel">
        <pfm-cancel-cta (onCancelClicked)="showPreviousFundedProgramDialog = false"></pfm-cancel-cta>
      </div>
    </div>
  </ng-template>
</ng-container>

<!--
<pfm-requests-funding-line-grid></pfm-requests-funding-line-grid>
-->
